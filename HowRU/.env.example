# HowRU Backend Environment Variables
# Copy this file to .env and fill in your values
# See END_TO_END_SPEC.md for full documentation

# ============================================
# HOSTING (Railway)
# ============================================
# Railway doesn't need env vars here - you configure them in the Railway dashboard
# Get started: https://railway.app
#
# Railway Setup Steps:
# 1. Create account at railway.app
# 2. New Project → Deploy from GitHub repo
# 3. Add services: API (Node.js), Worker (cron jobs)
# 4. Add all env vars below in Railway dashboard (Settings → Variables)
# 5. Railway auto-deploys on git push
#
# Railway provides:
# - RAILWAY_ENVIRONMENT (production/staging)
# - PORT (auto-assigned, use this for your server)
# - RAILWAY_PUBLIC_DOMAIN (your app URL)
#
# Useful Railway CLI commands:
#   railway login
#   railway link (connect local project)
#   railway up (deploy)
#   railway logs (view logs)
#   railway run <cmd> (run with env vars locally)

# ============================================
# DATABASE (Neon PostgreSQL)
# ============================================
# Get from: https://console.neon.tech
# Create project → Connection Details → Connection String
DATABASE_URL=postgresql://username:password@ep-xxx-xxx-123456.us-east-2.aws.neon.tech/howru?sslmode=require

# ============================================
# CACHE (Upstash Redis)
# ============================================
# Get from: https://console.upstash.com
# Create database → REST API → UPSTASH_REDIS_REST_URL
REDIS_URL=redis://default:xxx@us1-xxx-xxx.upstash.io:6379

# ============================================
# AUTHENTICATION (JWT RS256)
# ============================================
# Generate keypair:
#   openssl genrsa -out private.pem 2048
#   openssl rsa -in private.pem -pubout -out public.pem
#   base64 -i private.pem | tr -d '\n' > private_base64.txt
#   base64 -i public.pem | tr -d '\n' > public_base64.txt
JWT_PRIVATE_KEY_BASE64=<paste-base64-encoded-private-key>
JWT_PUBLIC_KEY_BASE64=<paste-base64-encoded-public-key>
JWT_ISSUER=howru.app
JWT_AUDIENCE=howru-api
JWT_ACCESS_TOKEN_EXPIRY=3600
JWT_REFRESH_TOKEN_EXPIRY=2592000

# ============================================
# TWILIO (SMS, Voice, OTP)
# ============================================
# Get from: https://console.twilio.com
# Account → Account Info → Account SID & Auth Token
# Verify → Services → Create Service → Get Verify SID
# Phone Numbers → Buy a number
TWILIO_ACCOUNT_SID=AC_your_account_sid
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_VERIFY_SID=VA_your_verify_service_sid
TWILIO_PHONE_NUMBER=+1234567890

# ============================================
# RESEND (Email - Magic Link & Fallback)
# ============================================
# Get from: https://resend.com/api-keys
# API Keys → Create API Key
RESEND_API_KEY=re_xxxxxxxxxxxxx
RESEND_FROM_EMAIL=HowRU <noreply@howru.app>

# ============================================
# REVENUECAT (Subscriptions)
# ============================================
# Get from: https://app.revenuecat.com
# Project Settings → API Keys
# iOS app → Public API Key (for mobile)
# Project → Secret API Key (for webhooks)
REVENUECAT_API_KEY=appl_xxxxxxxxxxxxx
REVENUECAT_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxx

# ============================================
# APPLE SIGN-IN
# ============================================
# Get from: https://developer.apple.com/account
# Certificates, IDs & Profiles → Keys → Create Sign in with Apple key
# Services IDs → Create for web auth
APPLE_CLIENT_ID=com.howru.app
APPLE_TEAM_ID=XXXXXXXXXX
APPLE_KEY_ID=XXXXXXXXXX
APPLE_PRIVATE_KEY_BASE64=<base64-encoded-p8-key>

# ============================================
# PUSH NOTIFICATIONS (APNs)
# ============================================
# Get from: https://developer.apple.com/account
# Certificates, IDs & Profiles → Keys → Create APNs key
APNS_KEY_ID=XXXXXXXXXX
APNS_TEAM_ID=XXXXXXXXXX
APNS_PRIVATE_KEY_BASE64=<base64-encoded-p8-key>
APNS_BUNDLE_ID=com.howru.app
APNS_ENVIRONMENT=development

# ============================================
# CLOUDFLARE R2 (Object Storage - Selfies)
# ============================================
# Get from: https://dash.cloudflare.com
# R2 → Create bucket → Manage R2 API Tokens
R2_ACCOUNT_ID=your_account_id
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
R2_BUCKET_NAME=howru-selfies
R2_PUBLIC_URL=https://selfies.howru.app

# ============================================
# APP CONFIGURATION
# ============================================
NODE_ENV=development
PORT=3000
API_URL=https://api.howru.app
WEB_URL=https://howru.app
CORS_ORIGINS=https://howru.app,http://localhost:3000

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_OTP_REQUESTS=3
RATE_LIMIT_OTP_WINDOW_HOURS=1
RATE_LIMIT_OTP_ATTEMPTS=5
RATE_LIMIT_API_REQUESTS=100
RATE_LIMIT_API_WINDOW_MINUTES=1

# ============================================
# FEATURE FLAGS (Optional)
# ============================================
ENABLE_VOICE_CALLS=true
ENABLE_EMERGENCY_ESCALATION=false
ENABLE_NOONLIGHT_INTEGRATION=false

# ============================================
# MONITORING (Optional)
# ============================================
# Sentry for error tracking
SENTRY_DSN=https://xxx@xxx.ingest.sentry.io/xxx

# ============================================
# DEVELOPMENT ONLY
# ============================================
# Set to true to use Twilio test credentials
USE_TWILIO_TEST_MODE=false
# Skip OTP verification (for testing)
SKIP_OTP_VERIFICATION=false
# Test phone number that always succeeds
TEST_PHONE_NUMBER=+15005550006
